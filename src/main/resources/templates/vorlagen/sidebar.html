<th:block th:fragment="sidebar">
  <!DOCTYPE html>
  <html lang="de" xmlns:sec="http://www.w3.org/1999/xhtml">
  <div th:insert="~{vorlagen/icon :: icon}"></div>

  <head>
    <meta charset="UTF-8">
    <title>Sidebar - Rheiner Zoo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
      /* Sidebar */
      .sidebar {
        width: 250px;
        height: 100vh;
        background: linear-gradient(135deg, #1f4e3e, #3e8e5b);
        color: white;
        position: fixed;
        top: 0;
        left: 0;
        transition: width 0.3s ease;
        z-index: 1000;
        display: flex;
        flex-direction: column;
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.2);
      }

      .sidebar.collapsed {
        width: 70px;
      }

      /* Sidebar-Links */
      .sidebar a {
        color: white;
        text-decoration: none;
        display: flex;
        align-items: center;
        padding: 12px 20px;
        transition: all 0.3s ease;
        font-size: 16px;
        font-weight: bold;
      }

      .sidebar.collapsed a span {
        display: none;
      }

      .sidebar a:hover {
        background: rgba(255, 255, 255, 0.2);
        border-radius: 8px;
      }

      /* Sidebar-Icons */
      .sidebar i {
        margin-right: 12px;
        font-size: 1.3rem;
      }

      .sidebar.collapsed i {
        margin-right: 0;
        text-align: center;
        width: 100%;
      }

      /* Aktive Seite */
      .sidebar a.active {
        background: rgba(255, 255, 255, 0.3);
        border-left: 4px solid #ffffff;
      }

      /* Men√º-Toggle */
      .menu-toggle {
        text-align: center;
        padding: 15px;
        cursor: pointer;
        background-color: #218838;
        color: white;
        transition: all 0.3s ease;
      }

      .menu-toggle:hover {
        background-color: #1e7e34;
      }

      /* Logout-Bereich */
      .logout-section {
        margin-top: auto;
        display: flex;
        align-items: center;
        padding: 12px 20px;
        background: rgba(255, 255, 255, 0.1);
        justify-content: space-between;
        font-weight: bold;
      }

      .logout-section span {
        font-size: 14px;
        font-weight: bold;
      }

      .logout-section:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      /* Countdown */
      .session-warning.red {
        color: #dc3545;
        font-weight: bold;
      }

      /* Haupt-Content */
      .main-content {
        margin-left: 250px;
        transition: margin-left 0.3s ease;
        padding: 20px;
      }

      .main-content.collapsed {
        margin-left: 70px;
      }
    </style>
  </head>

  <body>
  <!-- Sidebar -->
  <div class="sidebar" id="sidebar">
    <div class="menu-toggle" onclick="toggleSidebar()">
      <i class="fas fa-bars fa-2x"></i>
    </div>
    <a href="/dashboard"><i class="fas fa-tachometer-alt"></i> <span>Dashboard</span></a>
    <a sec:authorize="hasAuthority('FUTTERPLAN_MANAGEMENT_READ') or hasAuthority('*')" href="/futterplan">
      <i class="fas fa-clipboard-list"></i> <span>Futterpl√§ne</span>
    </a>
    <a sec:authorize="hasAuthority('FUTTER_MANAGEMENT_READ') or hasAuthority('*')" href="/futter">
      <i class="fas fa-utensils"></i> <span>Futterverwaltung</span>
    </a>
    <a sec:authorize="hasAuthority('USER_MANAGEMENT_READ') or hasAuthority('*')" href="/usermanagement">
      <i class="fas fa-users"></i> <span>Pflegerverwaltung</span>
    </a>
    <a sec:authorize="hasAuthority('REVIER_READ') or hasAuthority('*')" href="/revier">
      <i class="fas fa-map-marker-alt"></i> <span>Revierverwaltung</span>
    </a>
    <a sec:authorize="hasAuthority('TIER_READ') or hasAuthority('*')" href="/tier">
      <i class="fas fa-paw"></i> <span>Tierverwaltung</span>
    </a>
    <a sec:authorize="hasAuthority('LIEFERANT_READ') or hasAuthority('*')" href="/lieferanten">
      <i class="fas fa-truck"></i> <span>Lieferantenverwaltung</span>
    </a>
    <a sec:authorize="hasAuthority('ROLE_MANAGEMENT_READ') or hasAuthority('*')" href="/rollen">
      <i class="fas fa-id-card"></i> <span>Rollenverwaltung</span>
    </a>
    <a sec:authorize="hasAuthority('GEBAEUDE_MANAGEMENT_READ') or hasAuthority('*')" href="/gebaeudemanagement">
      <i class="fas fa-building"></i> <span>Geb√§udemanagement</span>
    </a>
    <a sec:authorize="hasAuthority('LOGS_READ') or hasAuthority('*')" href="/logs">
      <i class="fas fa-file-alt"></i> <span>Logs</span>
    </a>

    <!-- üõéÔ∏è Benachrichtigungen (Nur f√ºr NOTIFICATION_MANAGE oder *) -->
    <a sec:authorize="hasAuthority('NOTIFICATION_MANAGE') or hasAuthority('*')" href="/notifications">
      <i class="fas fa-bell"></i> <span>Benachrichtigungen</span>
    </a>
    <div class="logout-container">
      <a href="/settings">
        <i class="fas fa-user"></i> <span>Settings</span>
      </a>
    <!-- Logout + Countdown -->
    <div class="logout-section">
      <a id="logoutButton" href="/logout">
        <i class="fas fa-sign-out-alt"></i> <span>Logout</span>
      </a>
      <span id="countdown" class="session-warning">20:00</span>
    </div>
  </div>
</div>
  <!-- Script -->
  <script>
    let sessionTimeout = 1200; // 20 Minuten (1200 Sekunden)

    function updateCountdown() {
      let minutes = Math.floor(sessionTimeout / 60);
      let seconds = sessionTimeout % 60;
      document.getElementById("countdown").textContent =
              (minutes < 10 ? "0" : "") + minutes + ":" + (seconds < 10 ? "0" : "") + seconds;

      if (sessionTimeout === 120) {
        document.getElementById("countdown").classList.add("red");
      }

      if (sessionTimeout === 0) {
        window.location.href = "/login?error=session";
      }

      sessionTimeout--;
    }

    setInterval(updateCountdown, 1000);

    function toggleSidebar() {
      const sidebar = document.getElementById("sidebar");
      const mainContent = document.querySelector(".main-content");

      const isCollapsed = sidebar.classList.toggle("collapsed");
      localStorage.setItem("sidebarCollapsed", isCollapsed);

      if (mainContent) {
        mainContent.classList.toggle("collapsed");
      }
    }
  </script>
  </body>
  </html>
</th:block>